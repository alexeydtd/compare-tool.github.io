<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<link rel="shortcut icon" href="images/Search.svg" type="image/x-icon">
<title>compare-tool</title>
<style>
  body {
    font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    transition: background 0.3s, color 0.3s;
  }

  .container {
    max-width: 900px;
    margin: 40px auto;
    padding: 30px;
    border-radius: 16px;
    transition: background 0.3s, color 0.3s, box-shadow 0.3s;
  }

  h2 {
    text-align: center;
    margin-bottom: 25px;
    font-weight: 700;
  }

  label {
    font-weight: 600;
    display: block;
    margin: 15px 0 5px;
  }

  textarea {
    width: 100%;
    min-height: 120px;
    padding: 14px 16px;
    font-size: 15px;
    border-radius: 12px;
    border: 1px solid;
    resize: vertical;
    outline: none;
    transition: border 0.2s, box-shadow 0.2s, background 0.3s, color 0.3s;
  }

  textarea:focus {
    box-shadow: 0 0 8px rgba(76,175,80,0.2);
  }

  .buttons {
    margin-top: 20px;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  button {
    flex: 1;
    min-width: 120px;
    padding: 12px 20px;
    font-size: 15px;
    font-weight: 600;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    transition: 0.25s;
  }

  #btnCompare {
    background: linear-gradient(90deg, #4caf50, #43a047);
    color: white;
    box-shadow: 0 4px 12px rgba(76,175,80,0.3);
  }
  #btnCompare:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(76,175,80,0.35); }

  #btnClear {
    background: linear-gradient(90deg, #f44336, #e53935);
    color: white;
    box-shadow: 0 4px 12px rgba(244,67,54,0.3);
  }
  #btnClear:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(244,67,54,0.35); }

  #btnTheme {
    flex: 1;
    min-width: 120px;
    background: #607d8b;
    color: white;
    box-shadow: 0 4px 12px rgba(96,125,139,0.3);
  }
  #btnTheme:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(96,125,139,0.35); }

  .result-box {
    margin-top: 30px;
    padding: 18px 22px;
    border-radius: 16px;
    border: 1px solid;
    transition: background 0.3s, color 0.3s, border 0.3s;
  }

  .preview {
    white-space: pre-wrap;
    padding: 14px;
    border-radius: 12px;
    border: 1px solid;
    min-height: 60px;
    font-size: 15px;
    line-height: 1.5;
    margin-top: 12px;
    transition: background 0.3s, color 0.3s, border 0.3s;
  }

  .highlight {
    background: #ffe57f;
    border-radius: 4px;
    font-weight: 600;
    padding: 0 2px;
    animation: pulse 0.5s ease-in-out;
  }

  @keyframes pulse {
    0% { background-color: #ffe57f; }
    50% { background-color: #fff176; }
    100% { background-color: #ffe57f; }
  }

  /* Светлая тема по умолчанию */
  body.light {
    background: #f5f6fa;
    color: #222;
  }
  body.light .container { background: #fff; box-shadow: 0 8px 25px rgba(0,0,0,0.08); }
  body.light textarea { background: #fff; border-color: #ddd; color: #222; }
  body.light .result-box { background: #fefefe; border-color: #eee; color: #222; }
  body.light .preview { background: #fafafa; border-color: #ddd; color: #222; }

  /* Темная тема */
  body.dark {
    background: #1e1e2f;
    color: #e0e0e0;
  }
  body.dark .container { background: #2a2a3d; box-shadow: 0 8px 25px rgba(0,0,0,0.4); }
  body.dark textarea { background: #3b3b4f; border-color: #555; color: #e0e0e0; }
  body.dark .result-box { background: #33334d; border-color: #555; color: #e0e0e0; }
  body.dark .preview { background: #2c2c44; border-color: #555; color: #e0e0e0; }
  body.dark .highlight { background: #ffb74d; color: #222; }

  @media(max-width: 600px) {
    .buttons { flex-direction: column; }
    button { width: 100%; }
  }
</style>
</head>
<body class="light">
<div class="container">
  <h2>Подсветка фрагментов текста</h2>

  <label for="templateText">Шаблон (фрагменты через пробел):</label>
  <textarea id="templateText" placeholder="Например: рекл"></textarea>

  <label for="text2">Текст для проверки:</label>
  <textarea id="text2" placeholder="Введите текст для сравнения..."></textarea>

  <div class="buttons">
    <button id="btnCompare">Сравнить</button>
    <button id="btnClear">Очистить</button>
    <button id="btnTheme">Переключить тему</button>
  </div>

  <div class="result-box">
    <b>Текст с подсветкой:</b>
    <div id="preview" class="preview"></div>
  </div>
</div>

<script>
function escapeHtml(s) {
  return String(s).replace(/&/g, "&amp;")
                  .replace(/</g, "&lt;")
                  .replace(/>/g, "&gt;")
                  .replace(/"/g, "&quot;")
                  .replace(/'/g, "&#39;");
}

function compareByFragments() {
  const templateText = document.getElementById("templateText").value || "";
  const text2 = document.getElementById("text2").value || "";

  if (!templateText.trim()) { alert("Введите шаблон!"); return; }
  if (!text2.trim()) { alert("Введите текст для проверки!"); return; }

  const fragments = templateText
    .split(/\s+/)
    .filter(f => f.length > 0)
    .sort((a,b) => b.length - a.length);

  let highlighted = '';
  let i = 0;

  while (i < text2.length) {
    let matched = false;

    for (let frag of fragments) {
      if (text2.substr(i, frag.length).toLowerCase() === frag.toLowerCase()) {
        highlighted += '<span class="highlight">' + escapeHtml(text2.substr(i, frag.length)) + '</span>';
        i += frag.length;
        matched = true;
        break;
      }
    }

    if (!matched) {
      highlighted += escapeHtml(text2[i]);
      i++;
    }
  }

  const previewDiv = document.getElementById("preview");
  previewDiv.innerHTML = highlighted;

  const highlights = previewDiv.querySelectorAll('.highlight');
  highlights.forEach(el => {
    el.style.animation = 'none';
    void el.offsetWidth;
    el.style.animation = null;
  });
}

// Кнопки
document.getElementById("btnCompare").addEventListener("click", compareByFragments);
document.getElementById("btnClear").addEventListener("click", function() {
  document.getElementById("templateText").value = "";
  document.getElementById("text2").value = "";
  document.getElementById("preview").innerHTML = "";
});

// Переключение темы
document.getElementById("btnTheme").addEventListener("click", function() {
  document.body.classList.toggle('light');
  document.body.classList.toggle('dark');
});
</script>
</body>
</html>
